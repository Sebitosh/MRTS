# Set starting duration marker
SecAction "id:100116,phase:1, setvar:tx.duration_marker=0"

SecRule DURATION "@gt %{tx.duration_marker}" \
    "id:100117,\
    phase:1,\
    t:none,\
    log,\
    msg:'%{MATCHED_VAR_NAME} was caught in phase:1 with value %{MATCHED_VAR}',\
    setvar:tx.duration_marker=%{MATCHED_VAR},\
    ver:'MRTS/0.1'"

SecRule DURATION "@gt %{tx.duration_marker}" \
    "id:100118,\
    phase:2,\
    t:none,\
    log,\
    msg:'%{MATCHED_VAR_NAME} was caught in phase:2 with value %{MATCHED_VAR}',\
    setvar:tx.duration_marker=%{MATCHED_VAR},\
    ver:'MRTS/0.1'"

SecRule DURATION "@gt %{tx.duration_marker}" \
    "id:100119,\
    phase:3,\
    t:none,\
    log,\
    msg:'%{MATCHED_VAR_NAME} was caught in phase:3 with value %{MATCHED_VAR}',\
    setvar:tx.duration_marker=%{MATCHED_VAR},\
    ver:'MRTS/0.1'"

SecRule DURATION "@gt %{tx.duration_marker}" \
    "id:100120,\
    phase:4,\
    t:none,\
    log,\
    msg:'%{MATCHED_VAR_NAME} was caught in phase:4 with value %{MATCHED_VAR}',\
    setvar:tx.duration_marker=%{MATCHED_VAR},\
    ver:'MRTS/0.1'"

SecRule DURATION "@gt %{tx.duration_marker}" \
    "id:100121,\
    phase:5,\
    t:none,\
    log,\
    msg:'%{MATCHED_VAR_NAME} was caught in phase:5 with value %{MATCHED_VAR}',\
    setvar:tx.duration_marker=%{MATCHED_VAR},\
    ver:'MRTS/0.1'"

